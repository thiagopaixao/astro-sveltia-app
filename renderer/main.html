<!DOCTYPE html>
<html class="dark" lang="pt-BR"><head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>Documental</title>
<script src="https://cdn.tailwindcss.com?plugins=forms,typography,container-queries"></script>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&amp;display=swap" rel="stylesheet"/>
<link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet"/>
<script defer="" src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js"></script>
<script src="script.js" defer></script>
<style>
        body {
            font-family: 'Inter', sans-serif;
            -webkit-user-select: none;
            -ms-user-select: none;
            user-select: none;
        }
        .resize-handle {
            cursor: col-resize;
            width: 4px;
            background-color: #4a5568;
            flex-shrink: 0;
        }
        .resize-handle:hover,
        .resize-handle-active {
            background-color: #22c55e;
        }
        .resize-handle-horizontal {
            cursor: row-resize;
            height: 4px;
            background-color: #4a5568;
            flex-shrink: 0;
        }
        .resize-handle-horizontal:hover,
        .resize-handle-horizontal-active {
            background-color: #22c55e;
        }
        ::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }
        ::-webkit-scrollbar-track {
            background: #1f2937;
        }
        ::-webkit-scrollbar-thumb {
            background: #4b5563;
            border-radius: 4px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: #6b7280;
        }
        .initial-loader {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }
        .initial-loader__dot {
            width: 12px;
            height: 12px;
            border-radius: 9999px;
            background: #22c55e;
            opacity: 0.2;
            animation: loaderPulse 1.2s ease-in-out infinite;
        }
        .initial-loader__dot:nth-child(2) {
            animation-delay: 0.2s;
        }
        .initial-loader__dot:nth-child(3) {
            animation-delay: 0.4s;
        }
        @keyframes loaderPulse {
            0%, 60%, 100% {
                opacity: 0.2;
                transform: scale(0.9);
            }
            30% {
                opacity: 1;
                transform: scale(1.1);
            }
        }
    </style>
<script>
        tailwind.config = {
            darkMode: "class",
            theme: {
                extend: {
                    colors: {
                        primary: "#22c55e",
                        "background-light": "#f3f4f6",
                        "background-dark": "#111827",
                        "surface-light": "#ffffff",
                        "surface-dark": "#1f2937",
                        "text-light": "#111827",
                        "text-dark": "#f9fafb",
                        "muted-light": "#6b7280",
                        "muted-dark": "#9ca3af",
                        "accent-orange": "#ff5722",
                    },
                },
            },
        };
    </script>
</head>
<body :class="{'resizing': isResizing || isResizingVertical}" @mousemove.window="onResize($event)" @mouseup.window="stopResize()" class="bg-background-dark text-text-dark antialiased">
<div class="flex flex-col h-screen" x-data="{ 
    menuOpen: false, 
    activeTab: 'view', 
    editorWidth: 50,
    mainHeight: 70,
    consoleOpen: false,
    consoleTabs: [{id: 1, name: 'Server', type: 'server'}, {id: 2, name: 'Console', type: 'console'}],
    activeConsoleTab: 1,
    nextTerminalId: 1,
    serverOutput: '',
    consoleOutput: '',
    addressValue: 'https://documental.xyz/',
    baseURL: 'https://documental.xyz/',
    viewerUrl: null,
    editorUrl: null,
    isResizing: false,
    isResizingVertical: false,
    publishModalOpen: false,
    branchModalOpen: false,
    updateModalOpen: false,
    clearCacheModalOpen: false,
clearingCache: false,
    helpModalOpen: false,
    aboutModalOpen: false,
    exitModalOpen: false,
    selectedBranch: 'stage',
    newBranchName: '',
    currentBranch: 'stage',
    branchAction: 'change',
    copySuccess: false,
    initialLoading: true,
    viewerLoaded: false,
    editorLoaded: false,
    devServerUrl: 'https://documental.xyz/', // Default fallback
    viewerScreenshot: null,
    editorScreenshot: null,
    overlaySequence: 0,
    getDevServerUrl() {
        return this.devServerUrl || sessionStorage.getItem('devServerUrl') || this.baseURL;
    },
    get isAnyOverlayOpen() {
        return this.menuOpen || this.publishModalOpen || this.branchModalOpen || this.updateModalOpen || this.clearCacheModalOpen || this.helpModalOpen || this.aboutModalOpen || this.exitModalOpen;
    },
    startResize(event) {
        this.isResizing = true;
        event.target.classList.add('resize-handle-active');
    },
    stopResize() {
        if (this.isResizing) {
           this.$refs.resizeHandle.classList.remove('resize-handle-active');
        }
        if (this.isResizingVertical) {
           this.$refs.resizeHandleHorizontal.classList.remove('resize-handle-horizontal-active');
        }
        this.isResizing = false;
        this.isResizingVertical = false;
    },
    onResize(event) {
        if (this.isResizing) {
            const totalWidth = this.$refs.splitContainer.offsetWidth;
            const newEditorWidth = event.clientX - this.$refs.splitContainer.offsetLeft;
            this.editorWidth = (newEditorWidth / totalWidth) * 100;
        }
        if (this.isResizingVertical) {
            const totalHeight = this.$refs.mainContainer.offsetHeight;
            const newMainHeight = event.clientY - this.$refs.mainContainer.offsetTop;
            this.mainHeight = (newMainHeight / totalHeight) * 100;
        }
    },
    startVerticalResize(event) {
        this.isResizingVertical = true;
        event.target.classList.add('resize-handle-horizontal-active');
    },
    handleAddressInput(event) {
        if (!event.target.value.startsWith(this.baseURL)) {
             event.target.value = this.baseURL;
        }
        this.addressValue = event.target.value;
    },
     handleAddressClick(event) {
        if (event.target.selectionStart < this.baseURL.length) {
            event.target.setSelectionRange(this.baseURL.length, this.baseURL.length);
        }
    },
    handleAddressKeyDown(event) {
        if (event.target.selectionStart < this.baseURL.length && (event.key === 'Backspace' || event.key === 'Delete')) {
           event.preventDefault();
        }
    },
    handleAddressEnter(event) {
        if (event.key === 'Enter') {
            event.preventDefault();
            const normalized = event.target.value.trim();
            if (normalized !== this.addressValue) {
                this.addressValue = normalized;
            }
            if (this.addressValue !== this.viewerUrl) {
                this.loadViewer(this.addressValue);
            }
        }
    },
    copyAddress() {
        navigator.clipboard.writeText(this.addressValue).then(() => {
            this.copySuccess = true;
            setTimeout(() => { this.copySuccess = false; }, 2000);
        });
    },
    async confirmClearCache() {
        this.clearingCache = true;
        this.clearCacheModalOpen = false;
        this.menuOpen = false;
        
        try {
            // Clear cache using the new API
            const result = await window.electronAPI.clearBrowserCache();
            
            if (result && result.success) {
                // Reload both BrowserViews with fresh content
                const devServerUrl = this.getDevServerUrl();
                this.addressValue = devServerUrl;
                this.baseURL = devServerUrl;
                
                // Show loading state during reload
                this.initialLoading = true;
                this.viewerLoaded = false;
                this.editorLoaded = false;
                
                this.loadViewer(devServerUrl, true);
                this.loadEditor(`${devServerUrl}admin/index.html`, true);
            } else {
                alert('Erro ao limpar cache: ' + (result?.error || 'Erro desconhecido'));
            }
        } catch (error) {
            console.error('Error clearing cache:', error);
            alert('Erro ao limpar cache: ' + error.message);
        } finally {
            this.clearingCache = false;
        }
    },
    async getCurrentWindowState() {
        try {
            const editorUrl = await window.electronAPI.getBrowserViewUrl('editor');
            const viewerUrl = await window.electronAPI.getBrowserViewUrl('view');
            
            // Simplify consoleTabs to only serializable data
            const simplifiedConsoleTabs = this.consoleTabs.map(tab => ({
                id: tab.id,
                name: tab.name,
                type: tab.type
            }));
            
            // Limit output size to prevent IPC issues (last 5000 characters each)
            const maxOutputLength = 5000;
            const truncatedServerOutput = this.serverOutput.length > maxOutputLength 
                ? this.serverOutput.slice(-maxOutputLength) 
                : this.serverOutput;
            const truncatedConsoleOutput = this.consoleOutput.length > maxOutputLength 
                ? this.consoleOutput.slice(-maxOutputLength) 
                : this.consoleOutput;
            
            const windowState = {
                editorUrl: editorUrl || `${this.getDevServerUrl()}admin/index.html`,
                viewerUrl: viewerUrl || this.getDevServerUrl(),
                addressValue: this.addressValue,
                baseURL: this.baseURL,
                devServerUrl: this.getDevServerUrl(),
                activeTab: this.activeTab,
                editorWidth: this.editorWidth,
                mainHeight: this.mainHeight,
                consoleOpen: this.consoleOpen,
                currentBranch: this.currentBranch,
                serverOutput: truncatedServerOutput,
                consoleOutput: truncatedConsoleOutput,
                consoleTabs: simplifiedConsoleTabs,
                activeConsoleTab: this.activeConsoleTab,
                nextTerminalId: this.nextTerminalId
            };
            
            // Test if the object is serializable before sending
            try {
                JSON.stringify(windowState);
                return windowState;
            } catch (serializationError) {
                console.error('Window state serialization failed:', serializationError);
                // Return minimal state if serialization fails
                return {
                    editorUrl: editorUrl || `${this.getDevServerUrl()}admin/index.html`,
                    viewerUrl: viewerUrl || this.getDevServerUrl(),
                    addressValue: this.addressValue,
                    baseURL: this.baseURL,
                    devServerUrl: this.getDevServerUrl(),
                    activeTab: this.activeTab,
                    editorWidth: this.editorWidth,
                    mainHeight: this.mainHeight,
                    consoleOpen: this.consoleOpen,
                    currentBranch: this.currentBranch,
                    serverOutput: '',
                    consoleOutput: '',
                    consoleTabs: [{id: 1, name: 'Server', type: 'server'}, {id: 2, name: 'Console', type: 'console'}],
                    activeConsoleTab: 1,
                    nextTerminalId: 1
                };
            }
        } catch (error) {
            console.error('Error getting window state:', error);
            return null;
        }
    },
    async openNewWindow() {
        try {
            const windowState = await this.getCurrentWindowState();
            if (windowState) {
                console.log('Opening new window with state:', windowState);
                const result = await window.electronAPI.createNewWindowWithState(windowState);
                if (!result.success) {
                    throw new Error(result.error || 'Unknown error occurred');
                }
            } else {
                throw new Error('Failed to capture window state');
            }
        } catch (error) {
            console.error('Error opening new window:', error);
            alert('Erro ao abrir nova janela: ' + error.message);
        }
        this.menuOpen = false;
    },
    exitApp() {
        window.close();
    },
    addTerminalTab() {
        const newId = Date.now();
        this.consoleTabs.push({ id: newId, name: `Terminal ${this.nextTerminalId}`, type: 'terminal' });
        this.activeConsoleTab = newId;
        this.nextTerminalId++;
        if(!this.consoleOpen) {
            this.consoleOpen = true;
            this.mainHeight = 70;
        }
    },
    closeConsoleTab(tabId, event) {
        event.stopPropagation();
        const index = this.consoleTabs.findIndex(tab => tab.id === tabId);
        if (index > -1) {
            this.consoleTabs.splice(index, 1);
            if (this.activeConsoleTab === tabId && this.consoleTabs.length > 0) {
                 this.activeConsoleTab = this.consoleTabs[Math.max(0, index - 1)].id;
            } else if (this.consoleTabs.length === 0) {
                this.consoleOpen = false;
            }
        }
    },
    getWorkingBranchName() {
        const date = new Date();
        const year = date.getFullYear();
        const month = String(date.getMonth() + 1).padStart(2, '0');
        const day = String(date.getDate()).padStart(2, '0');
        const hours = String(date.getHours()).padStart(2, '0');
        const minutes = String(date.getMinutes()).padStart(2, '0');
        return `working_user_${year}${month}${day}-${hours}${minutes}_`;
    },
    async init() { // Make init an async function
        console.log('üöÄ INIT STARTED - Renderer initialization beginning');
        
        // Check if this window was opened with state parameters
        const urlParams = new URLSearchParams(window.location.search);
        const stateParam = urlParams.get('state');
        console.log('üîç URL params check - stateParam:', stateParam);
        
        if (stateParam) {
            try {
                // Decode and apply the window state
                const windowState = JSON.parse(atob(stateParam));
                console.log('Applying window state from URL:', windowState);
                this.applyWindowState(windowState);
            } catch (error) {
                console.error('Error parsing window state:', error);
                // Fall back to normal initialization
            }
        }

        // Listen for dev-server-url events from main process FIRST
        console.log('Setting up dev-server-url listener...');
        window.electronAPI.onDevServerUrl((devServerUrl) => {
            console.log('üéØ EVENT RECEIVED - dev server URL:', devServerUrl);
            console.log('Current devServerUrl before update:', this.devServerUrl);
            if (devServerUrl && devServerUrl !== this.devServerUrl) {
                console.log('üîÑ UPDATING URLs with dev server URL');
                this.devServerUrl = devServerUrl;
                sessionStorage.setItem('devServerUrl', devServerUrl);
                
                // Update URL variables
                this.baseURL = devServerUrl;
                this.addressValue = devServerUrl;
                this.viewerUrl = devServerUrl;
                this.editorUrl = `${devServerUrl}admin/index.html`;
                
                // Reload BrowserViews with the correct URLs
                this.loadViewer(devServerUrl, true);
                this.loadEditor(`${devServerUrl}admin/index.html`, true);
                
                console.log('‚úÖ Updated all URLs to dev server:', {
                    devServerUrl: this.devServerUrl,
                    baseURL: this.baseURL,
                    addressValue: this.addressValue,
                    viewerUrl: this.viewerUrl,
                    editorUrl: this.editorUrl
                });
            } else {
                console.log('‚ö†Ô∏è URL not updated - devServerUrl:', devServerUrl, 'current:', this.devServerUrl);
            }
        });

        // Always try to get devServerUrl from main process first
        console.log('üîç Checking devServerUrl - current value:', this.devServerUrl);
        console.log('üì° Calling getDevServerUrlFromMain...');
        const devServerUrl = await window.electronAPI.getDevServerUrlFromMain();
        console.log('üì° getDevServerUrlFromMain returned:', devServerUrl);
        
        if (devServerUrl) {
            this.devServerUrl = devServerUrl;
            sessionStorage.setItem('devServerUrl', devServerUrl);
            console.log('‚úÖ Set devServerUrl from main process:', devServerUrl);
        } else {
            const storedUrl = sessionStorage.getItem('devServerUrl');
            console.log('üíæ Checking sessionStorage - storedUrl:', storedUrl);
            if (storedUrl) {
                this.devServerUrl = storedUrl;
                console.log('‚úÖ Set devServerUrl from sessionStorage:', storedUrl);
            } else {
                console.log('‚ùå No devServerUrl found anywhere!');
                alert('Erro: URL do servidor de desenvolvimento n√£o encontrada. Por favor, inicie o projeto novamente.');
                return;
            }
        }

        // Set default values ONLY if not already set by window state
        // This prevents overwriting the captured state
        console.log('üîß Setting default URL values - devServerUrl:', this.devServerUrl);
        console.log('Before update - addressValue:', this.addressValue, 'baseURL:', this.baseURL, 'viewerUrl:', this.viewerUrl, 'editorUrl:', this.editorUrl);
        
        if (!this.addressValue || this.addressValue === 'https://documental.xyz/') {
            this.addressValue = this.devServerUrl;
            console.log('‚úÖ Updated addressValue to:', this.addressValue);
        }
        if (!this.baseURL || this.baseURL === 'https://documental.xyz/') {
            this.baseURL = this.devServerUrl;
            console.log('‚úÖ Updated baseURL to:', this.baseURL);
        }
        if (!this.viewerUrl) {
            this.viewerUrl = this.devServerUrl;
            console.log('‚úÖ Updated viewerUrl to:', this.viewerUrl);
        }
        if (!this.editorUrl) {
            this.editorUrl = `${this.devServerUrl}admin/index.html`;
            console.log('‚úÖ Updated editorUrl to:', this.editorUrl);
        }
        
        console.log('After update - addressValue:', this.addressValue, 'baseURL:', this.baseURL, 'viewerUrl:', this.viewerUrl, 'editorUrl:', this.editorUrl);
        
        console.log('Final initialization values:', {
            addressValue: this.addressValue,
            baseURL: this.baseURL,
            viewerUrl: this.viewerUrl,
            editorUrl: this.editorUrl,
            devServerUrl: this.devServerUrl
        });

        // Initial load of BrowserViews
        console.log('üöÄ Initial BrowserView load - viewerUrl:', this.viewerUrl, 'editorUrl:', this.editorUrl);
        this.loadViewer(this.viewerUrl, true);
        this.loadEditor(this.editorUrl, true);
        console.log('‚úÖ Initial BrowserView load completed');

        // Set initial visibility and bounds
        this.$nextTick(() => {
            this.updateBrowserViewBounds();
            this.updateBrowserViewVisibility();
        });

        // Watch for changes in activeTab to update BrowserView visibility and bounds
        this.$watch('activeTab', (tab) => {
            this.updateBrowserViewVisibility();
            this.$nextTick(() => {
                this.updateBrowserViewBounds();
            });
            if (tab === 'editor') {
                this.updateAddressFromBrowser('editor');
            } else {
                this.updateAddressFromBrowser('view');
            }
        });

        // Watch for changes in consoleOpen or layout-driven values to update bounds once DOM is ready
        this.$watch('consoleOpen', () => {
            this.$nextTick(() => this.updateBrowserViewBounds());
        });
        this.$watch('mainHeight', () => {
            this.$nextTick(() => this.updateBrowserViewBounds());
        });
        this.$watch('editorWidth', () => {
            this.$nextTick(() => this.updateBrowserViewBounds());
        });

        // Watch for overlay toggles to manage BrowserView visibility with previews
        this.$watch('isAnyOverlayOpen', (isOpen) => {
            this.handleOverlayChange(isOpen);
        });

        window.addEventListener('resize', () => {
            this.updateBrowserViewBounds();
        });

        if (window.electronAPI && window.electronAPI.onBrowserViewLoaded) {
            window.electronAPI.onBrowserViewLoaded(({ viewName, url }) => {
                const target = viewName === 'editor' ? 'editor' : 'view';
                this.updateAddressFromBrowser(target, url);
                this.markViewLoaded(target);
            });
        }

        this.updateAddressFromBrowser('view');


        // Only load project state if not already loaded from window state
        if (!this.serverOutput && !this.consoleOutput) {
            const projectId = sessionStorage.getItem('currentProjectId');
            if (projectId) {
                const savedState = JSON.parse(sessionStorage.getItem(`projectCreationState-${projectId}`));
                if (savedState && savedState.steps) {
                    savedState.steps.forEach(step => {
                        if (step.log) {
                            if (step.title.includes('Executando servidor do modo dev')) {
                                this.serverOutput += step.log + '\n';
                            } else {
                                this.consoleOutput += step.log + '\n';
                            }
                        }
                    });
                }
            }
        }
    },
    applyWindowState(windowState) {
        console.log('Applying window state:', windowState);
        
        // Apply the captured window state to this window
        // Only apply if the value exists and is not the default
        if (windowState.editorUrl && windowState.editorUrl !== 'https://documental.xyz/admin/index.html') {
            this.editorUrl = windowState.editorUrl;
        }
        if (windowState.viewerUrl && windowState.viewerUrl !== 'https://documental.xyz/') {
            this.viewerUrl = windowState.viewerUrl;
        }
        if (windowState.addressValue && windowState.addressValue !== 'https://documental.xyz/') {
            this.addressValue = windowState.addressValue;
        }
        if (windowState.baseURL && windowState.baseURL !== 'https://documental.xyz/') {
            this.baseURL = windowState.baseURL;
        }
        if (windowState.devServerUrl && windowState.devServerUrl !== 'https://documental.xyz/') {
            this.devServerUrl = windowState.devServerUrl;
        }
        if (windowState.activeTab) this.activeTab = windowState.activeTab;
        if (windowState.editorWidth) this.editorWidth = windowState.editorWidth;
        if (windowState.mainHeight) this.mainHeight = windowState.mainHeight;
        if (windowState.consoleOpen !== undefined) this.consoleOpen = windowState.consoleOpen;
        if (windowState.currentBranch) this.currentBranch = windowState.currentBranch;
        if (windowState.serverOutput) this.serverOutput = windowState.serverOutput;
        if (windowState.consoleOutput) this.consoleOutput = windowState.consoleOutput;
        if (windowState.consoleTabs) this.consoleTabs = windowState.consoleTabs;
        if (windowState.activeConsoleTab) this.activeConsoleTab = windowState.activeConsoleTab;
        if (windowState.nextTerminalId) this.nextTerminalId = windowState.nextTerminalId;
        
        // Store devServerUrl in sessionStorage for persistence
        if (windowState.devServerUrl) {
            sessionStorage.setItem('devServerUrl', windowState.devServerUrl);
        }
        
        console.log('State applied. Current values:', {
            addressValue: this.addressValue,
            baseURL: this.baseURL,
            viewerUrl: this.viewerUrl,
            editorUrl: this.editorUrl,
            devServerUrl: this.devServerUrl
        });
    },
    loadViewer(url, force = false) {
        if (!url) {
            return;
        }
        if (!force && url === this.viewerUrl) {
            return;
        }
        this.viewerUrl = url;
        window.electronAPI.loadBrowserViewUrl('view', url);
        if (this.activeTab !== 'editor') {
            this.addressValue = url;
        }
        if (this.initialLoading) {
            this.viewerLoaded = false;
        }
    },
    loadEditor(url, force = false) {
        if (!url) {
            return;
        }
        if (!force && url === this.editorUrl) {
            return;
        }
        this.editorUrl = url;
        window.electronAPI.loadBrowserViewUrl('editor', url);
        if (this.activeTab === 'editor') {
            this.addressValue = url;
        }
        if (this.initialLoading) {
            this.editorLoaded = false;
        }
    },
    getActiveBrowserViewName() {
        return this.activeTab === 'editor' ? 'editor' : 'view';
    },
    async browserGoBack() {
        if (!window.electronAPI || !window.electronAPI.browserViewGoBack) {
            return;
        }
        const target = this.getActiveBrowserViewName();
        try {
            const moved = await window.electronAPI.browserViewGoBack(target);
            if (moved) {
                await this.updateAddressFromBrowser(target);
            }
        } catch (error) {
            console.error('Erro ao acionar voltar:', error);
        }
    },
    async browserReload() {
        if (!window.electronAPI || !window.electronAPI.browserViewReload) {
            return;
        }
        const target = this.getActiveBrowserViewName();
        try {
            const reloaded = await window.electronAPI.browserViewReload(target);
            if (reloaded) {
                await this.updateAddressFromBrowser(target);
            }
        } catch (error) {
            console.error('Erro ao recarregar BrowserView:', error);
        }
    },
    browserGoHome() {
        if (!window.electronAPI) {
            return;
        }
        const target = this.getActiveBrowserViewName();
        if (target === 'editor') {
            const editorHome = `${this.baseURL}admin/index.html`;
            this.addressValue = editorHome;
            this.loadEditor(editorHome, true);
        } else {
            this.addressValue = this.baseURL;
            this.loadViewer(this.baseURL, true);
        }
    },
    async updateAddressFromBrowser(target, urlHint = null) {
        if (!window.electronAPI || !window.electronAPI.getBrowserViewUrl) {
            return;
        }
        try {
            let currentUrl = urlHint;
            if (!currentUrl) {
                currentUrl = await window.electronAPI.getBrowserViewUrl(target);
            }
            if (!currentUrl || currentUrl === 'about:blank') {
                return;
            }
            if (target === 'editor') {
                this.editorUrl = currentUrl;
                if (this.activeTab === 'editor') {
                    this.addressValue = currentUrl;
                }
            } else {
                this.viewerUrl = currentUrl;
                if (this.activeTab !== 'editor') {
                    this.addressValue = currentUrl;
                }
            }
            this.markViewLoaded(target);
        } catch (error) {
            console.error('Erro ao sincronizar endere√ßo do BrowserView:', error);
        }
    },
    markViewLoaded(target) {
        if (target === 'editor') {
            this.editorLoaded = true;
        } else {
            this.viewerLoaded = true;
        }
        if (this.initialLoading && this.editorLoaded && this.viewerLoaded) {
            this.initialLoading = false;
        }
    },
    updateBrowserViewBounds() {
        const headerHeight = 64; // matches h-16 header
        const footerHeight = 32; // matches h-8 footer
        const windowWidth = window.innerWidth;
        const windowHeight = window.innerHeight;

        let mainContentTop = headerHeight;
        let mainContentBottom = windowHeight - footerHeight;

        if (this.consoleOpen && this.$refs.consoleContainer) {
            const consoleRect = this.$refs.consoleContainer.getBoundingClientRect();
            mainContentBottom = Math.max(mainContentTop, Math.round(consoleRect.top));
        }

        const availableHeight = Math.max(0, Math.round(mainContentBottom - mainContentTop));
        const contentY = Math.round(mainContentTop);
        const fullWidth = Math.max(0, Math.round(windowWidth));
        const handleWidth = 4;

        if (this.activeTab === 'view') {
            window.electronAPI.setBrowserViewBounds('view', {
                x: 0,
                y: contentY,
                width: fullWidth,
                height: availableHeight
            });
            window.electronAPI.setBrowserViewBounds('editor', { x: 0, y: 0, width: 0, height: 0 });
        } else if (this.activeTab === 'editor') {
            window.electronAPI.setBrowserViewBounds('editor', {
                x: 0,
                y: contentY,
                width: fullWidth,
                height: availableHeight
            });
            window.electronAPI.setBrowserViewBounds('view', { x: 0, y: 0, width: 0, height: 0 });
        } else if (this.activeTab === 'split') {
            const editorPaneWidth = Math.max(0, Math.round((windowWidth * this.editorWidth) / 100));
            const viewerPaneX = editorPaneWidth + handleWidth;
            const viewerPaneWidth = Math.max(0, fullWidth - viewerPaneX);

            window.electronAPI.setBrowserViewBounds('editor', {
                x: 0,
                y: contentY,
                width: editorPaneWidth,
                height: availableHeight
            });
            window.electronAPI.setBrowserViewBounds('view', {
                x: viewerPaneX,
                y: contentY,
                width: viewerPaneWidth,
                height: availableHeight
            });
        }
    },
    updateBrowserViewVisibility() {
        window.electronAPI.setBrowserViewVisibility('view', this.activeTab === 'view' || this.activeTab === 'split');
        window.electronAPI.setBrowserViewVisibility('editor', this.activeTab === 'editor' || this.activeTab === 'split');
    },
    async prepareOverlaySnapshots() {
        const capture = async (viewName) => {
            try {
                return await window.electronAPI.captureBrowserViewPage(viewName);
            } catch (error) {
                console.error(`Falha ao capturar ${viewName}:`, error);
                return null;
            }
        };

        if (this.activeTab === 'split') {
            const [editorShot, viewerShot] = await Promise.all([
                capture('editor'),
                capture('view')
            ]);
            this.editorScreenshot = editorShot;
            this.viewerScreenshot = viewerShot;
        } else if (this.activeTab === 'editor') {
            this.editorScreenshot = await capture('editor');
            this.viewerScreenshot = null;
        } else {
            this.viewerScreenshot = await capture('view');
            this.editorScreenshot = null;
        }
    },
    clearOverlaySnapshots() {
        this.viewerScreenshot = null;
        this.editorScreenshot = null;
    },
    async handleOverlayChange(isOpen) {
        const currentSeq = ++this.overlaySequence;

        if (isOpen) {
            await this.prepareOverlaySnapshots();
            if (this.overlaySequence !== currentSeq) {
                return;
            }
            await window.electronAPI.setAllBrowserViewVisibility(false);
        } else {
            await window.electronAPI.setAllBrowserViewVisibility(true);
            if (this.overlaySequence !== currentSeq) {
                return;
            }
            this.clearOverlaySnapshots();
            this.$nextTick(() => this.updateBrowserViewBounds());
        }
    }
}">
<header class="flex items-center justify-between h-16 px-4 bg-surface-dark border-b border-gray-700 shrink-0">
<div class="flex items-center space-x-2">
<svg class="h-6 w-6 text-primary" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
<path d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"></path>
</svg>
<h1 class="text-xl font-bold text-text-dark">Documental</h1>
</div>
<div class="flex items-center space-x-2 ml-4">
<button :class="{ 'bg-gray-700 ring-2 ring-primary': activeTab === 'editor', 'hover:bg-gray-700': activeTab !== 'editor' }" @click="activeTab = 'editor'" class="p-2 rounded-full focus:outline-none">
<span :class="{'text-primary': activeTab === 'editor', 'text-muted-dark': activeTab !== 'editor'}" class="material-icons">edit</span>
</button>
<button :class="{ 'bg-gray-700 ring-2 ring-primary': activeTab === 'view', 'hover:bg-gray-700': activeTab !== 'view' }" @click="activeTab = 'view'" class="p-2 rounded-full focus:outline-none">
<span :class="{'text-primary': activeTab === 'view', 'text-muted-dark': activeTab !== 'view'}" class="material-icons">visibility</span>
</button>
<button :class="{ 'bg-gray-700 ring-2 ring-primary': activeTab === 'split', 'hover:bg-gray-700': activeTab !== 'split' }" @click="activeTab = 'split'" class="p-2 rounded-full focus:outline-none">
<span :class="{'text-primary': activeTab === 'split', 'text-muted-dark': activeTab !== 'split'}" class="material-icons">vertical_split</span>
</button>
</div>
<div class="flex-1 mx-4">
<div class="relative flex items-center">
<div class="flex w-full items-center bg-background-dark border border-gray-600 rounded-md transition-colors">
<div class="flex items-center pl-2 pr-1 space-x-1">
<button @click.prevent="browserGoBack()" class="w-7 h-7 flex items-center justify-center rounded-full hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-primary/20" aria-label="Voltar">
<span class="material-icons text-muted-dark text-sm">arrow_back</span>
</button>
<button @click.prevent="browserReload()" class="w-7 h-7 flex items-center justify-center rounded-full hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-primary/20" aria-label="Recarregar">
<span class="material-icons text-muted-dark text-sm">refresh</span>
</button>
<button @click.prevent="browserGoHome()" class="w-7 h-7 flex items-center justify-center rounded-full hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-primary/20" aria-label="P√°gina inicial">
<span class="material-icons text-muted-dark text-sm">home</span>
</button>
</div>
<div class="flex items-center flex-1 px-2 space-x-2">
<span class="material-icons text-muted-dark text-base">link</span>
<input :disabled="activeTab === 'editor'" @click="handleAddressClick($event)" @input="handleAddressInput($event)" @keydown="handleAddressKeyDown($event)" @keydown.enter="handleAddressEnter($event)" class="flex-1 bg-transparent py-2 text-sm text-text-dark placeholder-muted-dark focus:outline-none focus:ring-0 border-0 disabled:opacity-50 disabled:cursor-not-allowed" type="text" x-model="addressValue"/>
</div>
<button @click.prevent="copyAddress()" class="px-2 h-10 flex items-center text-muted-dark hover:text-text-dark focus:outline-none" aria-label="Copiar endere√ßo">
<span class="material-icons" x-show="!copySuccess">content_copy</span>
<span class="material-icons text-primary" style="display: none;" x-show="copySuccess">check</span>
</button>
</div>
</div>
</div>
<div class="flex items-center space-x-2">
<button @click="updateModalOpen = true" class="px-4 py-2 text-sm font-semibold text-white bg-accent-orange rounded-md hover:bg-orange-500 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-background-dark focus:ring-accent-orange">
                Atualizar
            </button>
<button @click="publishModalOpen = true" class="px-4 py-2 text-sm font-semibold text-white bg-primary rounded-md hover:bg-green-500 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-background-dark focus:ring-primary">
                Publicar
            </button>
<div class="relative">
<button @click="menuOpen = !menuOpen" class="p-2 rounded-full hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-primary">
<span class="material-icons text-muted-dark">menu</span>
</button>
</div>
</div>
</header>
<div class="flex flex-col flex-1 overflow-hidden" x-ref="mainContainer">
<main :style="{ height: consoleOpen ? mainHeight + '%' : '100%' }" class="flex-1 flex overflow-hidden relative">
    <!-- Placeholder for BrowserViews, which are managed by the main process -->
    <div class="w-full h-full absolute inset-0 pointer-events-none"></div>

    <div x-cloak x-show="initialLoading || clearingCache" class="absolute inset-0 z-30 flex flex-col items-center justify-center space-y-4 bg-background-dark">
        <div class="initial-loader">
            <span class="initial-loader__dot"></span>
            <span class="initial-loader__dot"></span>
            <span class="initial-loader__dot"></span>
        </div>
        <p class="text-xs uppercase tracking-[0.3em] text-muted-dark" x-text="clearingCache ? 'limpando cache...' : 'carregando ambiente'"></p>
    </div>

    <!-- Screenshot overlays for modals/menus -->
    <template x-if="isAnyOverlayOpen">
        <div class="absolute inset-0 pointer-events-none">
            <template x-if="activeTab === 'split'">
                <div class="absolute inset-0 flex">
                    <div class="relative" :style="{ width: editorWidth + '%' }">
                        <template x-if="editorScreenshot">
                            <img :src="editorScreenshot" class="w-full h-full object-cover" alt="Editor preview"/>
                        </template>
                        <div class="absolute inset-0 bg-black bg-opacity-60"></div>
                    </div>
                    <div class="relative flex-1">
                        <template x-if="viewerScreenshot">
                            <img :src="viewerScreenshot" class="w-full h-full object-cover" alt="Viewer preview"/>
                        </template>
                        <div class="absolute inset-0 bg-black bg-opacity-60"></div>
                    </div>
                </div>
            </template>
            <template x-if="activeTab !== 'split'">
                <div class="absolute inset-0 relative">
                    <template x-if="(activeTab === 'view' ? viewerScreenshot : editorScreenshot)">
                        <img :src="activeTab === 'view' ? viewerScreenshot : editorScreenshot" class="w-full h-full object-cover" alt="Browser preview"/>
                    </template>
                    <div class="absolute inset-0 bg-black bg-opacity-60"></div>
                </div>
            </template>
        </div>
    </template>

    <div class="flex w-full h-full absolute inset-0" x-ref="splitContainer" x-show="activeTab === 'split'">
        <div :style="{ width: editorWidth + '%' }" class="h-full overflow-auto pointer-events-none" x-ref="splitEditorPane"></div>
        <div @mousedown.prevent="startResize($event)" class="resize-handle" x-ref="resizeHandle"></div>
        <div class="flex-1 h-full overflow-auto pointer-events-none"></div>
    </div>
</main>
<template x-if="consoleOpen">
<div :style="{ height: `calc(100% - ${mainHeight}%)` }" class="flex flex-col flex-1 bg-surface-dark overflow-hidden shrink-0" x-ref="consoleContainer">
<div @mousedown.prevent="startVerticalResize($event)" class="resize-handle-horizontal w-full" x-ref="resizeHandleHorizontal"></div>
<div class="flex items-center justify-between p-2 border-b border-gray-700">
<div class="flex items-center space-x-1 overflow-x-auto">
<template :key="tab.id" x-for="tab in consoleTabs">
<button :class="{'bg-gray-700 text-primary': activeConsoleTab === tab.id, 'hover:bg-gray-800': activeConsoleTab !== tab.id}" @click="activeConsoleTab = tab.id" class="px-3 py-1 text-sm rounded-md flex items-center space-x-2 shrink-0">
<span x-text="tab.name"></span>
<span @click="closeConsoleTab(tab.id, $event)" class="material-icons text-muted-dark text-xs hover:text-text-dark" x-show="tab.type === 'terminal'">close</span>
</button>
</template>
</div>
<div class="flex items-center space-x-2">
<button @click="addTerminalTab()" class="p-1 rounded-full hover:bg-gray-700">
<span class="material-icons text-muted-dark text-base">add</span>
</button>
<button @click="consoleOpen = false" class="p-1 rounded-full hover:bg-gray-700">
<span class="material-icons text-muted-dark text-base">close</span>
</button>
</div>
</div>
<div class="p-4 flex-1 overflow-y-auto font-mono text-sm text-muted-dark">
<template :key="tab.id" x-for="tab in consoleTabs">
<div x-show="activeConsoleTab === tab.id">
<div x-show="tab.type === 'server'">
<pre class="text-xs text-muted-dark whitespace-pre-wrap font-mono" x-text="serverOutput"></pre>
</div>
<div x-show="tab.type === 'console'">
<pre class="text-xs text-muted-dark whitespace-pre-wrap font-mono" x-text="consoleOutput"></pre>
</div>
<div x-show="tab.type === 'terminal'">
<p class="text-green-400">user@documental:~$</p>
</div>
</div>
</template>
</div>
</div>
</template>
</div>
<footer class="flex items-center justify-between h-8 px-4 bg-surface-dark border-t border-gray-700 text-xs text-muted-dark shrink-0">
<div class="flex items-center space-x-4">
<button @click="branchModalOpen = true" class="flex items-center space-x-1 hover:text-text-dark">
<span class="material-icons text-sm">source_control</span>
<span class="font-bold" x-text="currentBranch"></span>
</button>
<button class="flex items-center space-x-1 hover:text-text-dark">
<span class="material-icons text-sm">folder_open</span>
<span>/Users/thiagopaixao/documental</span>
</button>
</div>
<div class="flex items-center space-x-4">
<a class="flex items-center space-x-1 hover:text-text-dark underline" href="https://github.com/thiagopaixao/astro_sveltia" target="_blank">
<svg class="w-4 h-4" fill="currentColor" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0016 8c0-4.42-3.58-8-8-8z" fill-rule="evenodd"></path></svg>
<span>thiagopaixao/astro_sveltia</span>
</a>
<a class="flex items-center space-x-1 hover:text-text-dark underline" href="https://github.com/thiagopaixao/astro_sveltia/commit/a1b2c3d" target="_blank">
<span class="material-icons text-sm">commit</span>
<span>a1b2c3d</span>
</a>
<div class="flex items-center space-x-1">
<span class="material-icons text-sm">chat_bubble_outline</span>
<span>feat: Implement new feature</span>
</div>
<button @click="consoleOpen = !consoleOpen; if(consoleOpen) mainHeight = 70;" class="flex items-center space-x-1 hover:text-text-dark" :class="{'text-primary': consoleOpen}" title="Toggle Terminal">
<span class="material-icons text-sm">terminal</span>
</button>
</div>
</footer>
<div @click.outside="menuOpen = false" class="absolute top-16 right-4 z-10" style="display: none;" x-show="menuOpen" x-transition:enter="transition ease-out duration-200" x-transition:enter-end="opacity-100 transform scale-100" x-transition:enter-start="opacity-0 transform scale-95" x-transition:leave="transition ease-in duration-75" x-transition:leave-end="opacity-0 transform scale-95" x-transition:leave-start="opacity-100 transform scale-100">
<div class="w-56 bg-surface-dark rounded-md shadow-lg border border-gray-700">
<nav class="p-2">
<ul class="space-y-1">
  <li>
    <a @click.prevent="consoleOpen = !consoleOpen; if(consoleOpen) mainHeight = 70; menuOpen = false" class="flex items-center px-4 py-2 text-text-dark hover:bg-gray-700 rounded-md" href="#">
      <span class="material-icons mr-3">terminal</span>
      <span>Console</span>
    </a>
  </li>
  <li>
    <a @click.prevent="clearCacheModalOpen = true" class="flex items-center px-4 py-2 text-text-dark hover:bg-gray-700 rounded-md" href="#">
      <span class="material-icons mr-3">delete_sweep</span>
      <span>Limpar cache</span>
    </a>
  </li>
  <li>
    <a @click.prevent="openNewWindow()" class="flex items-center px-4 py-2 text-text-dark hover:bg-gray-700 rounded-md" href="#">
      <span class="material-icons mr-3">open_in_new</span>
      <span>Nova Janela</span>
    </a>
  </li>
  <li>
    <a class="flex items-center px-4 py-2 text-text-dark hover:bg-gray-700 rounded-md" href="#">
      <span class="material-icons mr-3">folder_open</span>
      <span>Outro Projeto</span>
    </a>
  </li>
  <li class="border-t border-gray-700 my-2"></li>
  <li>
    <a class="flex items-center px-4 py-2 text-text-dark hover:bg-gray-700 rounded-md" href="#" data-navigate="config.html">
      <span class="material-icons mr-3">settings</span>
      <span>Configura√ß√µes</span>
    </a>
  </li>
  <li>
    <a @click.prevent="helpModalOpen = true" class="flex items-center px-4 py-2 text-text-dark hover:bg-gray-700 rounded-md" href="#">
      <span class="material-icons mr-3">help_outline</span>
      <span>Ajuda</span>
    </a>
  </li>
  <li>
    <a @click.prevent="aboutModalOpen = true" class="flex items-center px-4 py-2 text-text-dark hover:bg-gray-700 rounded-md" href="#">
      <span class="material-icons mr-3">info_outline</span>
      <span>Sobre</span>
    </a>
  </li>
  <li class="border-t border-gray-700 my-2"></li>
  <li>
    <a @click.prevent="exitModalOpen = true" class="flex items-center px-4 py-2 text-text-dark hover:bg-gray-700 rounded-md" href="#">
      <span class="material-icons mr-3">exit_to_app</span>
      <span>Sair</span>
    </a>
  </li>
</ul>
</nav>
</div>
</div>
<div class="fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50" style="display: none;" x-show="updateModalOpen">
<div @click.outside="updateModalOpen = false" class="bg-surface-dark rounded-lg shadow-xl p-6 w-full max-w-md">
<h3 class="text-lg font-medium text-text-dark">Confirmar Atualiza√ß√£o</h3>
<p class="mt-2 text-sm text-muted-dark">Voc√™ tem certeza que deseja atualizar a branch '<span class="font-bold text-primary" x-text="currentBranch"></span>'? Isso executar√° um `git pull`.</p>
<div class="mt-4 flex justify-end space-x-2">
<button @click="updateModalOpen = false" class="px-4 py-2 text-sm font-medium text-muted-dark bg-gray-700 rounded-md hover:bg-gray-600">Cancelar</button>
<button @click="updateModalOpen = false;" class="px-4 py-2 text-sm font-medium text-white bg-accent-orange rounded-md hover:bg-orange-500">Confirmar</button>
</div>
</div>
</div>
<div class="fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50" style="display: none;" x-show="publishModalOpen">
<div @click.outside="publishModalOpen = false" class="bg-surface-dark rounded-lg shadow-xl p-6 w-full max-w-lg">
<h3 class="text-lg font-medium text-text-dark">Publicar Altera√ß√µes</h3>
<p class="mt-2 text-sm text-muted-dark">Selecione a branch para publicar.</p>
<div class="mt-4 space-y-4">
<div>
<label class="text-sm font-medium text-text-dark">Selecionar branch existente</label>
<select class="mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-600 bg-background-dark focus:outline-none focus:ring-primary focus:border-primary sm:text-sm rounded-md text-text-dark" x-model="selectedBranch">
<option value="main">main</option>
<option value="stage">stage</option>
</select>
</div>
</div>
<div class="mt-6 flex justify-end space-x-2">
<button @click="publishModalOpen = false" class="px-4 py-2 text-sm font-medium text-muted-dark bg-gray-700 rounded-md hover:bg-gray-600">Cancelar</button>
<button @click="publishModalOpen = false;" class="px-4 py-2 text-sm font-medium text-white bg-primary rounded-md hover:bg-green-500">Publicar</button>
</div>
</div>
</div>
<div class="fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50" style="display: none;" x-show="branchModalOpen">
<div @click.outside="branchModalOpen = false" class="bg-surface-dark rounded-lg shadow-xl p-6 w-full max-w-lg">
<h3 class="text-lg font-medium text-text-dark">Gerenciar Branches</h3>
<p class="mt-2 text-sm text-muted-dark">Selecione uma branch existente ou crie uma nova branch local.</p>
<div class="mt-4 space-y-4">
<div>
<label class="text-sm font-medium text-text-dark">Branch Atual</label>
<p class="mt-1 text-primary font-bold" x-text="currentBranch"></p>
</div>
<div>
<label class="text-sm font-medium text-text-dark">A√ß√£o</label>
<select class="mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-600 bg-background-dark focus:outline-none focus:ring-primary focus:border-primary sm:text-sm rounded-md text-text-dark" x-model="branchAction">
<option value="change">Mudar para branch existente</option>
<option value="create">Criar nova branch local</option>
</select>
</div>
<div x-show="branchAction === 'change'">
<label class="text-sm font-medium text-text-dark">Mudar para branch</label>
<select class="mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-600 bg-background-dark focus:outline-none focus:ring-primary focus:border-primary sm:text-sm rounded-md text-text-dark" x-model="selectedBranch">
<option value="main">main</option>
<option value="stage">stage</option>
</select>
</div>
<div x-show="branchAction === 'create'">
<label class="block text-sm font-medium text-text-dark" for="new-branch-name">Nome da nova branch</label>
<div class="mt-1 flex rounded-md shadow-sm">
<span class="inline-flex items-center px-3 rounded-l-md border border-r-0 border-gray-600 bg-gray-700 text-muted-dark text-sm" x-text="getWorkingBranchName()"></span>
<input class="flex-1 block w-full rounded-none rounded-r-md bg-background-dark border-gray-600 focus:ring-primary focus:border-primary sm:text-sm text-text-dark" id="new-branch-name" placeholder="adicione-um-sufixo-aqui" type="text" x-model="newBranchName"/>
</div>
</div>
</div>
<div class="mt-6 flex justify-end space-x-2">
<button @click="branchModalOpen = false" class="px-4 py-2 text-sm font-medium text-muted-dark bg-gray-700 rounded-md hover:bg-gray-600">Cancelar</button>
<button @click="branchModalOpen = false; if(branchAction === 'change') currentBranch = selectedBranch;" class="px-4 py-2 text-sm font-medium text-white bg-primary rounded-md hover:bg-green-500" x-show="branchAction === 'change'">Mudar Branch</button>
<button @click="branchModalOpen = false;" class="px-4 py-2 text-sm font-medium text-white bg-primary rounded-md hover:bg-green-500" x-show="branchAction === 'create'">Criar Branch</button>
</div>
</div>
</div>
<div class="fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50" style="display: none;" x-show="clearCacheModalOpen">
<div @click.outside="clearCacheModalOpen = false" class="bg-surface-dark rounded-lg shadow-xl p-6 w-full max-w-md">
<h3 class="text-lg font-medium text-text-dark">Limpar Cache</h3>
<p class="mt-2 text-sm text-muted-dark">Tem certeza de que deseja limpar o cache? Todos os dados de hist√≥rico, cache e cookies ser√£o perdidos definitivamente. Esta a√ß√£o n√£o pode ser desfeita.</p>
<div class="mt-4 flex justify-end space-x-2">
<button @click="clearCacheModalOpen = false" class="px-4 py-2 text-sm font-medium text-muted-dark bg-gray-700 rounded-md hover:bg-gray-600">Cancelar</button>
<button @click="confirmClearCache()" class="px-4 py-2 text-sm font-medium text-white bg-red-600 rounded-md hover:bg-red-500">Limpar</button>
</div>
</div>
</div>
<div class="fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50" style="display: none;" x-show="helpModalOpen">
<div @click.outside="helpModalOpen = false" class="bg-surface-dark rounded-lg shadow-xl p-6 w-full max-w-lg">
<h3 class="text-lg font-medium text-text-dark">Ajuda</h3>
<div class="mt-2 space-y-4 text-sm text-muted-dark">
<p>Bem-vindo ao Documental Desktop! Aqui est√£o algumas dicas para come√ßar:</p>
<ul class="list-disc list-inside space-y-2">
<li>Use os bot√µes <span class="material-icons text-xs align-middle">edit</span>, <span class="material-icons text-xs align-middle">visibility</span>, e <span class="material-icons text-xs align-middle">vertical_split</span> para alternar entre os modos de visualiza√ß√£o.</li>
<li>A barra de endere√ßo permite que voc√™ navegue para diferentes p√°ginas do seu projeto.</li>
<li>Use o menu <span class="material-icons text-xs align-middle">menu</span> para acessar mais op√ß√µes como o Console e Configura√ß√µes.</li>
<li>A barra inferior mostra informa√ß√µes √∫teis sobre o seu projeto Git.</li>
</ul>
<p>Para mais informa√ß√µes, visite nossa <a class="text-primary hover:underline" href="#">documenta√ß√£o online</a>.</p>
</div>
<div class="mt-6 flex justify-end">
<button @click="helpModalOpen = false" class="px-4 py-2 text-sm font-medium text-white bg-primary rounded-md hover:bg-green-500">Entendido</button>
</div>
</div>
</div>
<div class="fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50" style="display: none;" x-show="aboutModalOpen">
<div @click.outside="aboutModalOpen = false" class="bg-surface-dark rounded-lg shadow-xl p-6 w-full max-w-md text-center">
<div class="flex justify-center mb-4">
<svg class="h-12 w-12 text-primary" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
<path d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"></path>
</svg>
</div>
<h3 class="text-lg font-medium text-text-dark">Documental Desktop</h3>
<p class="mt-1 text-sm text-muted-dark">Vers√£o 1.0.0 (Electron)</p>
<p class="mt-4 text-xs text-muted-dark">¬© 2023 Documental. Todos os direitos reservados.</p>
<div class="mt-6 flex justify-center">
<button @click="aboutModalOpen = false" class="px-4 py-2 text-sm font-medium text-white bg-primary rounded-md hover:bg-green-500">Fechar</button>
</div>
</div>
</div>
<div class="fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50" style="display: none;" x-show="exitModalOpen">
<div @click.outside="exitModalOpen = false" class="bg-surface-dark rounded-lg shadow-xl p-6 w-full max-w-md">
<h3 class="text-lg font-medium text-text-dark">Sair do Documental</h3>
<p class="mt-2 text-sm text-muted-dark">Tem certeza de que deseja sair do aplicativo?</p>
<div class="mt-4 flex justify-end space-x-2">
<button @click="exitModalOpen = false" class="px-4 py-2 text-sm font-medium text-muted-dark bg-gray-700 rounded-md hover:bg-gray-600">Cancelar</button>
<button @click="exitApp()" class="px-4 py-2 text-sm font-medium text-white bg-red-600 rounded-md hover:bg-red-500">Sair</button>
</div>
</div>
</div>
</div>

</body></html>
